%===[ What is this? ]===========================================================

% όζος • (ózos)
%   1. node
%   2. nodule
%   3. gnarl, knag
%   4. gall

% This module implements an alternative parsing mechanism
% for TiKz nodes. In essence, what happens is
%   \kDOzos ... {CONTENT}; -> \node ... [node contents={CONTENT}];
% so the node contents is always passed through the TikZ key.

\usetikzlibrary{kodi.koinos}

\pgfkeys{/ozos/every node/.style={}}

\def\kDOzos%
{\kDOzosFetchThen
{\kDOzosMaybeDumpThen
\kDOzosOutput}}

\let\kDOzosFetchThen\kDFetchOptAndGrpThen

\def\kDOzosMaybeDumpThen#1{
\kDDump{options: '\the\kDOptTok'}
\kDDump{content: '\the\kDGrpTok'}
#1}

\def\kDOzosOutput{
  \edef\Act{
    \noexpand\node
      [/ozos/every node]
      \the\kDOptTok
      [/tikz/node contents={\the\kDGrpTok}];
  }
  \Act}
