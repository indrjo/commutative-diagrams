%% tikzlibrarykodi.mandyas.code.tex
%% Copyright 2017 Paolo Brasolin
%
% This work may be distributed and/or modified under the
% conditions of the LaTeX Project Public License, either version 1.3
% of this license or (at your option) any later version.
% The latest version of this license is in
%   <http://www.latex-project.org/lppl.txt>
% and version 1.3 or later is part of all distributions of LaTeX
% version 2005/12/01 or later.
%
% This work has the LPPL maintenance status `maintained'.
%
% The Current Maintainer of this work is Paolo Brasolin
% who can be contacted at <paolo.brasolin@gmail.com>.
%
% This work consists of the following files:

% μανδύας • (mandýas)
%   1. cloak
%   2. mantle
%   3. dolman

% Mandias defines the aesthetics aspect of the user level functionality,
% together with some baseline configuration.

% TODO: clean these up
\usetikzlibrary[calc]
% \usetikzlibrary[decorations.pathreplacing]
% \usetikzlibrary{decorations.pathmorphing}
% \usetikzlibrary[decorations.markings]
% \usetikzlibrary[arrows.meta]

\pgfqkeys{/kD}{
%==[ universal styles ]=========================================================
  every layout/.append style={
    square
  },
  every object/.append style={},
  every arrow/.append style={},
  every label/.append style={
    auto,
    inner sep=0.5ex,
    font=\everymath\expandafter{\the\everymath\scriptstyle}
  },
%==[ arrow styles ]=============================================================
  /kD/arrows/.cd,
    crossing over/clearance/.initial=0.5ex,
    crossing over/color/.initial=white,
    crossing over/.style={
      /tikz/preaction={
        -,
        draw=\pgfkeysvalueof{/kD/arrows/crossing over/color},
        line width=\pgfkeysvalueof{/kD/arrows/crossing over/clearance},
      },
    },
    shove/.style={
      /tikz/transform canvas={
        /tikz/shift={($(\tikztostart)!#1!-90:(\tikztotarget)-(\tikztostart)$)}
      }
    },
    slide/.style={
      /tikz/transform canvas={
        /tikz/shift={($(\tikztostart)!#1!0:(\tikztotarget)-(\tikztostart)$)}
      }
    },
%==[ label styles ]=============================================================
  /kD/labels/.cd,
    mid/.style={
      /tikz/fill=white,
      /tikz/shape=circle,
      /tikz/anchor=center,
      /tikz/inner sep=.25ex
    },
%=[ objects styles ]============================================================
  /kD/objects/.cd,
%=[ lattice styles ]============================================================
  /kD/layouts/.cd,
    rectangular/.style 2 args={
      /tikz/column sep={#1,between origins},
      /tikz/row sep={#2,between origins}
    },
    square/.style={
      /kD/layouts/rectangular={#1}{#1}
    },
    golden/.style={
      /kD/layouts/rectangular={#1}{0.618*#1}
    },
    comb/.style={
      /kD/layouts/rectangular={#1}{sqrt(3/4)*#1},
      /tikz/every odd row/.append style={/tikz/xshift=tan(30)*#1}
    },
    comb/.default=4em,
    square/.default=4em,
    golden/.default=4em
}
