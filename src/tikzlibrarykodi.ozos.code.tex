%===[ What is this? ]===========================================================

% όζος • (ózos)
%   1. node
%   2. nodule
%   3. gnarl, knag
%   4. gall

% This module implements an alternative parsing mechanism
% for TiKz nodes. In essence, what happens is
%   \kDOzos ... {CONTENT}; -> \node ... [node contents={CONTENT}];
% so the node contents is always passed through the TikZ key.

\usetikzlibrary{kodi.koinos}

\catcode`@=11

\pgfkeys{/ozos/every node/.style={}}

\def\kDOzosOutput%
{\ifkDOzosDebug\kDOzosDebugDump\fi%
\edef\Act{\noexpand\node[/ozos/every node]\the\kDOptTok[node contents=\the\kDGrpTok];}\Act}


\newif\ifkDOzosDebug
\kDOzosDebugfalse

\def\kDOzosDebugDump{\pgfextra{
  % \bgroup\let~\space
  % \immediate\write\file{'\the\pgfmatrixcurrentrow-\the\pgfmatrixcurrentcolumn':}
  \immediate\write\file{options: '\the\kDOptTok'}
  \immediate\write\file{content: '\the\kDGrpTok'}
  % \egroup
}}

\def\kDOzos{\kDFetchOptAndGrpThen\kDOzosOutput}

\catcode`@=12
